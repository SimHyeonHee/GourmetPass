<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.uhi.gourmet.store.StoreMapper">

	<insert id="insertStore" parameterType="com.uhi.gourmet.store.StoreVO">
		INSERT INTO STORE (
			store_id, 
			user_id, 
			store_name, 
			store_tel, 
			store_zip, 
			store_addr1, 
			store_addr2, 
			store_lat, 
			store_lon, 
			store_category, 
			store_desc,     store_time,
			res_unit,
			store_img,
			store_cnt
		) VALUES (
			SEQ_STORE.NEXTVAL, 
			#{user_id}, 
			#{store_name}, 
			#{store_tel}, 
			#{store_zip}, 
			#{store_addr1}, 
			#{store_addr2}, 
			#{store_lat}, 
			#{store_lon}, 
			#{store_category}, -- 카테고리 (JSP에 추가 필요하거나 추후 업데이트)
			#{store_info},     -- VO 변수명 (JSP name과 일치)
			#{store_time},
			#{res_unit},
			#{store_img},
			0                  -- 초기 조회수는 0
		)
	</insert>

	<select id="selectPopularStore" resultType="com.uhi.gourmet.store.StoreVO">
		<![CDATA[
		SELECT * FROM (
			SELECT 
				store_id, 
				store_name, 
				store_category, 
				store_img, 
				store_addr1, 
				store_cnt,
				store_lat,
				store_lon
			FROM STORE 
			ORDER BY store_cnt DESC
		)
		WHERE ROWNUM <= 4
		]]>
	</select>

	<select id="selectStoreByCategory" parameterType="String" resultType="com.uhi.gourmet.store.StoreVO">
		SELECT * FROM STORE
		WHERE store_category = #{store_category}
		ORDER BY store_cnt DESC
	</select>

	<select id="selectStoreDetail" parameterType="int" resultType="com.uhi.gourmet.store.StoreVO">
		SELECT * FROM STORE
		WHERE store_id = #{store_id}
	</select>

</mapper>